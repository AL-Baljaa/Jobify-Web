<html>
<head>
    <title>Job Seeker page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>
<body class="bg-light">
    <header class="bg-primary text-white p-3 sticky-top">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <img src="jobify.png" alt="Jobify Logo" class="img-fluid" style="height: 2.5em;">
            <div>
                <a href="signin.html" class="btn btn-outline-light me-2">Sign In</a>
                <a href="signup.html" class="btn btn-warning">Sign Up</a>
            </div>
        </div>
    </header>

    <!-- Navigation bar-->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link " href="home.html"><i class="fas fa-home me-1"></i> Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="job-listing.html"><i class="fas fa-search me-1"></i> Job Listing</a></li>
                    <li class="nav-item"><a class="nav-link active" href="job-seeker.html"><i class="fas fa-users me-1"></i> Job Seeker</a></li>
                    <li class="nav-item"><a class="nav-link" href="employer.html"><i class="fas fa-briefcase me-1"></i> Employer</a></li>
                    <li class="nav-item"><a class="nav-link" href="trainee.html"><i class="fas fa-project-diagram me-1"></i> Trainee and Undergraduate</a></li>
                    <li class="nav-item"><a class="nav-link" href="skills.html"><i class="fas fa-chalkboard me-1"></i> Skill Development</a></li>
                    <li class="nav-item"><a class="nav-link" href="questionnaire.html"><i class="fas fa-clipboard-check"></i> Questionnaire</a></li>
                    <li class="nav-item"><a class="nav-link" href="funpage.html"><i class="fas fa-gamepad"></i> fun page</a></li>
                    <li class="nav-item"><a class="nav-link" href="calculate.html"><i class="fas fa-equals"></i> calculate page</a></li>
                </ul>
            </div>
        </div>
    </nav>


    <main class="container my-4">
        <!-- Section for jobseekers to update their profile-->
        <div class="card section-card mb-4">
            <div class="card-body">
                <h3 class="card-title"><i class="fas fa-user-edit me-2"></i>Update Your Profile</h3>
                <form id="addSeekerForm">
                    <div class="mb-3">
                        <label for="name" class="form-label"><i class="fas fa-user me-1"></i> Full Name</label>
                        <input type="text" class="form-control" id="name" placeholder="Enter your full name" required>
                    </div>
                    <div class="mb-3">
                        <label for="title" class="form-label"><i class="fas fa-briefcase text-warning me-1"></i> Job Title</label>
                        <input type="text" class="form-control" id="title" placeholder="e.g., Software Engineer">
                    </div>
                    <div class="mb-3">
                        <label for="skills" class="form-label"><i class="fas fa-brain text-danger me-1"></i> Skills</label>
                        <input type="text" class="form-control" id="skills" placeholder="e.g., Web Development, Research">
                    </div>
                    <div class="mb-3">
                        <label for="about" class="form-label"><i class="fas fa-edit text-info me-1"></i> About You</label>
                        <textarea class="form-control" id="about" rows="3" placeholder="Write a short bio..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="cv" class="form-label"><i class="fas fa-file-alt me-1"></i> Upload Your CV</label>
                        <input class="form-control" type="file" id="cv">
                    </div>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-save me-1"></i> Save Profile</button>
                </form>
            </div>
        </div>


        <!-- Search bar to find job seekers by their name or job title -->
        <div class="card section-card mb-4">
            <div class="card-body">
                <h5 class="card-title"><i class="fas fa-search me-2"></i>Search Job Seekers</h5>
                <input type="text" id="searchSeekers" class="form-control" placeholder="Search by name or title...">
            </div>
        </div>


        <!-- table for registered job seekers with details-->
        <div class="card section-card mb-4">
            <div class="card-body">
                <h3 class="card-title"><i class="fas fa-users me-2"></i>Job Seekers</h3>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Title</th>
                                <th>Skills</th>
                                <th>About</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="jobSeekersBody">
                            <!-- Filled by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Saved Jobs Section -->
        <div class="card section-card mb-4">
            <div class="card-body">
                <h3 class="card-title"><i class="fas fa-bookmark text-warning me-2"></i>Saved Jobs</h3>
                <div class="table-responsive">
                    <table class="table table-hover" id="savedJobsTable">
                        <thead>
                            <tr>
                                <th>Job Title</th>
                                <th>Company</th>
                                <th>Location</th>
                                <th>Description</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="jobsBody">
                            <!-- Filled by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Application Status Section -->
        <div class="card section-card mb-4">
            <div class="card-body">
                <h3 class="card-title"><i class="fas fa-clipboard-list text-secondary me-2"></i>Application Status</h3>
                <div class="mb-3">
                    <p class="mb-1">Lead UX Designer - <span class="badge bg-warning text-dark status-badge">Under Review</span></p>
                </div>
                <div>
                    <p class="mb-1">Software Engineer - <span class="badge bg-success status-badge">Offer Received</span></p>
                </div>
            </div>
        </div>

        <!-- Recommended Jobs Section -->
        <div class="card section-card mb-4">
            <div class="card-body">
                <h3 class="card-title"><i class="fas fa-lightbulb text-warning me-2"></i>Recommended For You</h3>
                <div class="mb-3">
                    <p class="fw-bold mb-1">Systems Engineer <span class="badge bg-primary status-badge">95% Match</span></p>
                    <p class="text-muted mb-2">Location: Dubai, UAE | $120,000 - $140,000</p>
                    <button class="btn btn-primary" onclick="saveRecommendedJob()">Save Job</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white py-3 mt-4">
        <div class="container">
            <div class="d-flex justify-content-center mb-2">
                <a href="about.html" class="text-white mx-3 text-decoration-none">About Us</a>
                <a href="contact.html" class="text-white mx-3 text-decoration-none">Contact Us</a>
            </div>
            <div class="text-center">
                Â© 2025 Jobify. All rights reserved.
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

    
    <script>
        
        // showError function: Displays error message below the respective field
        function showError(fieldId, message) {
            const field = document.getElementById(fieldId);
            // Remove any existing error message to avoid duplicates
           const existingError = field.closest('.form-group')?.querySelector('.error-message');
          if (existingError) {
            existingError.remove();
          }

            // Create error element
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.style.color = 'red';
            errorDiv.style.fontSize = '0.9em';
            errorDiv.textContent = message;

            // Append error message after the input field
            field.parentNode.insertBefore(errorDiv, field.nextSibling);
        }

        // Validate Full Name
        function validateName() {
            const name = document.getElementById('name').value.trim();
            const nameRegex = /^[a-zA-Z\s]{3,}$/;
            if (!name) {
                showError('name', 'Full Name is required');
                return false;
            } else if (!nameRegex.test(name)) {
                showError('name', 'Name must be at least 3 characters and contain only letters');
                return false;
            }
            return true;
        }

        // Validate Job Title
        function validateTitle() {
            const title = document.getElementById('title').value.trim();
            if (!title) {
                showError('title', 'Job Title is required');
                return false;
            } else if (title.length < 2) {
                showError('title', 'Job Title must be at least 2 characters');
                return false;
            }
            return true;
        }

        // Validate Skills
        function validateSkills() {
            const skills = document.getElementById('skills').value.trim();
            if (!skills) {
                showError('skills', 'Skills are required');
                return false;
            } else if (skills.length < 5) {
                showError('skills', 'Please provide more details about your skills');
                return false;
            }
            return true;
        }

        // Validate About Section
        function validateAbout() {
            const about = document.getElementById('about').value.trim();
            if (!about) {
                showError('about', 'About section is required');
                return false;
            } else if (about.length < 20) {
                showError('about', 'About section should be at least 20 characters');
                return false;
            } else if (about.length > 500) {
                showError('about', 'About section should not exceed 500 characters');
                return false;
            }
            return true;
        }

        // Validate CV File
        function validateCV() {
            const cvInput = document.getElementById('cv');
            if (cvInput.files.length === 0) {
                showError('cv', 'CV file is required');
                return false;
            } else {
                const file = cvInput.files[0];
                const allowedTypes = ['application/pdf', 'application/msword', '.docx'];
                const maxSize = 5 * 1024 * 1024; // 5MB

                if (!allowedTypes.includes(file.type)) {
                    showError('cv', 'Only PDF and Word documents are allowed');
                    return false;
                } else if (file.size > maxSize) {
                    showError('cv', 'File size should not exceed 5MB');
                    return false;
                }
            }
            return true;
        }

        // Main Validation Function for Form Submission
        function validateAddSeekerForm() {
            // Clear previous errors
            document.querySelectorAll('.error-message').forEach(el => el.remove());
 
            // Validate all fields
            const isNameValid = validateName();
            const isTitleValid = validateTitle();
            const isSkillsValid = validateSkills();
            const isAboutValid = validateAbout();
            const isCVValid = validateCV();

            // Return true only if all validations pass
            return isNameValid && isTitleValid && isSkillsValid && isAboutValid && isCVValid;
        }

        // Real-time validation on field exit (blur) or change
        document.getElementById('name').addEventListener('blur', validateName);
        document.getElementById('title').addEventListener('blur', validateTitle);
        document.getElementById('skills').addEventListener('blur', validateSkills);
        document.getElementById('about').addEventListener('blur', validateAbout);
        document.getElementById('cv').addEventListener('change', validateCV);

        // Form submission (full validation)
        document.getElementById('addSeekerForm').addEventListener('submit', function(e) {
            e.preventDefault();

            if (validateAddSeekerForm()) {
                const name = document.getElementById('name').value.trim();
                const title = document.getElementById('title').value.trim();
                const skills = document.getElementById('skills').value.trim();
                const about = document.getElementById('about').value.trim();

                const newSeeker = new JobSeeker(name, title, skills, about);
                jobSeekers.push(newSeeker);
                displaySeekers(jobSeekers);
                this.reset();
                alert('Profile updated successfully!');
            }
        });


        // Define an object constructor function for the jobseeker
        function JobSeeker(name, title, skills, about) {
            this.name = name;
            this.title = title;
            this.skills = skills;
            this.about = about;
        }

        // Define an object constructor function for the job
        function Job(title, company, location, description) {
            this.title = title;
            this.company = company;
            this.location = location;
            this.description = description;
        }

        // Initialize an array of jobseeker objects to store thier data
        let jobSeekers = [
            new JobSeeker("Alice Johnson", "Web Developer", "HTML, CSS, JS", "Passionate front-end developer."),
            new JobSeeker("Bob Smith", "Data Analyst", "Python, SQL", "Loves numbers and insights.")
        ];

        // Initialize an array of job objects to store the saved jobs
        let savedJobs = [
            new Job("Software Engineer", "Emirates Tech Innovations", "Dubai, UAE", 
                   "Designs and develops enterprise-level software applications. Works with cloud technologies and collaborates with product managers and designers to deliver high-performance solutions."),
            new Job("Full Stack Developer", "Oman Digital Solutions", "Muscat, Oman", 
                   "Develops secure and scalable server-side systems using Node.js and Python. Optimizes databases and supports integration with third-party services.")
        ];

        // Functions to display job seekers data in a table
        function displaySeekers(seekers) {
            // Get the table body element
            const tableBody = document.getElementById('jobSeekersBody');
            // Clear old data from the table
            tableBody.innerHTML = ""; 
            //Loop through each job seeker object
            seekers.forEach((seeker, index) => { 
                const row = `<tr>
                    <td>${seeker.name}</td>
                    <td>${seeker.title}</td>
                    <td>${seeker.skills}</td>
                    <td>${seeker.about}</td>
                    <td><button class="btn btn-danger btn-sm" onclick="deleteSeeker(${index})">Delete</button></td>
                </tr>`;
                // Append the row to the table
                tableBody.innerHTML += row;
            });
        }

        // function to display jobs data in a table
        function displaySavedJobs() {
            // Get the table body element
            const tableBody = document.getElementById('jobsBody');
            // Clear old data from the table
            tableBody.innerHTML = ""; 
            // Loop through each saved job object
            savedJobs.forEach((job, index) => {
                const row = `<tr>
                    <td>${job.title}</td>
                    <td>${job.company}</td>
                    <td>${job.location}</td>
                    <td>${job.description}</td>
                    <td>
                        <button class="btn btn-sm btn-primary me-1">Apply</button>
                        <button class="btn btn-sm btn-danger" onclick="removeSavedJob(${index})">Remove</button>
                    </td>
                </tr>`;
                //Append the row to the table
                tableBody.innerHTML += row;
            });
        }

        // Add new job seeker using Event Listener
        document.getElementById('addSeekerForm').addEventListener('submit', function(e) {
            // prevent
            e.preventDefault();
            // Get the input value of each object(name, title, skills, about)
            const name = document.getElementById('name').value.trim();
            const title = document.getElementById('title').value.trim();
            const skills = document.getElementById('skills').value.trim();
            const about = document.getElementById('about').value.trim();

            //validate that all fields are filled
            if (name && title && skills && about) {
                //create a new job seeker object
                const newSeeker = new JobSeeker(name, title, skills, about);
                // Add the new job seeker to the array
                jobSeekers.push(newSeeker);
                //update the table
                displaySeekers(jobSeekers);
                // Clear form
                this.reset();
            }
        });

        // Function to delete a job seeker from the list
        function deleteSeeker(index) {
            // remove the job seeker at the current index
            jobSeekers.splice(index, 1);
            //update the table
            displaySeekers(jobSeekers);
        }

        // Function to remove a saved job from the list
        function removeSavedJob(index) {
            savedJobs.splice(index, 1);
            // update the table
            displaySavedJobs();
        }

        // Function to save a job if it doesn't exist
        function saveJob(job) {
            // Check if job already exists
            const exists = savedJobs.some(savedJob => 
                savedJob.title === job.title && 
                savedJob.company === job.company
            );
            
            // if the job doesn't exist
            if (!exists) {
                savedJobs.push(job);
                // update the table to display the new job
                displaySavedJobs();
                // messages to the user 
                alert('Job saved successfully!');
            } else {
                alert('This job is already in your saved list.');
            }
        }

        // Function to save a recommended job 
        function saveRecommendedJob() {
            const newJob = new Job(
                "Systems Engineer",
                "Tech Solutions Inc.",
                "Dubai, UAE",
                "Working on cutting-edge systems with a focus on cloud technologies and AI integration."
            );
            // call the saveJob function to save the job
            saveJob(newJob);
        }

        // Search for a jobseeker using Event Listener
        document.getElementById('searchSeekers').addEventListener('input', function(e) {
            // Get the search text and convert to lowercase
            const searchText = e.target.value.toLowerCase();
            const filteredSeekers = jobSeekers.filter(seeker => 
                // Fillter by name and job title
                seeker.name.toLowerCase().includes(searchText) || 
                seeker.title.toLowerCase().includes(searchText)
            );
            displaySeekers(filteredSeekers);
        });

        // display the initial data(job seekers data, saved jobs) when the page loads
        displaySeekers(jobSeekers);
        displaySavedJobs();
    </script>
</body>
</html>